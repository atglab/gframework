{
    "type": "Ext.app.ViewController",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "gmremainview",
        "designer|userClassName": "gmre.MainViewViewController"
    },
    "designerId": "ebc99873-80bd-496c-9f9c-8637393558ab",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "button#next_btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "onNextButtonClick",
                "implHandler": [
                    "//1) Check input values in the form fields",
                    "",
                    "//2) Move to the next panel",
                    "var tabPanel = button.up('tabpanel');",
                    "",
                    "var thisPanel = button.up('panel');",
                    "var ref_this = thisPanel.getReference();",
                    "",
                    "var nextPanel;",
                    "",
                    "if(ref_this == 'step0_panel'){",
                    "    nextPanel = this.lookupReference('step1_panel');",
                    "    ",
                    "}else if(ref_this == 'step1_panel'){",
                    "    nextPanel = this.lookupReference('step2_panel');",
                    "",
                    "}else if(ref_this == 'step2_panel'){",
                    "    nextPanel = this.lookupReference('step3_panel');",
                    "}",
                    "",
                    "nextPanel.enable();",
                    "",
                    "tabPanel.setActiveTab(nextPanel);",
                    "",
                    "//3)",
                    "",
                    "/*",
                    "Ext.Msg.alert({title: 'Test N',",
                    "    msg: 'TEST Next Btn',",
                    "    icon: Ext.Msg.INFO,",
                    "    buttons: Ext.Msg.OK});",
                    "*/",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onNextButtonClick",
            "designerId": "b21d6772-fa56-4369-87ce-99515eaec4ba"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "button#prev_btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "onPreviousButtonClick",
                "implHandler": [
                    "//1) Move to the previous panel",
                    "var tabPanel = button.up('tabpanel');",
                    "",
                    "var thisPanel = button.up('panel');",
                    "var ref_this = thisPanel.getReference();",
                    "",
                    "var prevPanel;",
                    "",
                    "if(ref_this == 'step1_panel'){",
                    "    prevPanel = this.lookupReference('step0_panel');",
                    "}else if(ref_this == 'step2_panel'){",
                    "    prevPanel = this.lookupReference('step1_panel');",
                    "}else if(ref_this == 'step3_panel'){",
                    "    prevPanel = this.lookupReference('step2_panel');",
                    "}",
                    "",
                    "prevPanel.enable();",
                    "//thisPanel.disable();",
                    "",
                    "tabPanel.setActiveTab(prevPanel);"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onPreviousButtonClick",
            "designerId": "78e862be-0fc1-4786-a391-c4c182512967"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "button#submit_btn",
                "designer|targetType": "Ext.button.Button",
                "fn": "onSubmitButtonClick",
                "implHandler": [
                    "",
                    "var step0Panel = this.lookupReference('step0_panel');",
                    "var step1Panel = this.lookupReference('step1_panel');",
                    "var step2Panel = this.lookupReference('step2_panel');",
                    "var step3Panel = this.lookupReference('step3_panel');",
                    "",
                    "var tabPanel = button.up('tabpanel');",
                    "",
                    "var step0Form = step0Panel.getForm();",
                    "var step1Form = step1Panel.getForm();",
                    "var step2Form = step2Panel.getForm();",
                    "var step3Form = step3Panel.getForm();",
                    "",
                    "//console.log(Ext.util.JSON.encode(step0Form.getValues()));",
                    "//console.log(Ext.util.JSON.encode(step1Form.getValues()));",
                    "//console.log(Ext.util.JSON.encode(step2Form.getValues()));",
                    "//console.log(Ext.util.JSON.encode(step3Form.getValues()));",
                    "",
                    "var myThis = this;",
                    "",
                    "Ext.Ajax.request({",
                    "    url: '/api/doAnalyze',",
                    "    timeout: 10000,",
                    "    method: 'POST',",
                    "    params: {",
                    "        step0: Ext.util.JSON.encode(step0Form.getValues()),",
                    "        step1: Ext.util.JSON.encode(step1Form.getValues()),",
                    "        step2: Ext.util.JSON.encode(step2Form.getValues()),",
                    "        step3: Ext.util.JSON.encode(step3Form.getValues()),",
                    "    },",
                    "    success: function(response){",
                    "",
                    "        var resValue = response.responseText;",
                    "",
                    "        //console.log('OK');",
                    "        //console.log(resValue);",
                    "",
                    "        var data = Ext.util.JSON.decode(resValue);",
                    "",
                    "        myThis.createDialog(data.players, data.mechanics, data.siteArea);",
                    "",
                    "    },",
                    "    failure: function(response){",
                    "        console.log('Fail');",
                    "    }",
                    "});"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onSubmitButtonClick",
            "designerId": "fad5ac68-0b96-41b5-87b3-2c33c091e389"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "players",
                    "mechanics",
                    "siteArea"
                ],
                "fn": "createDialog",
                "implHandler": [
                    "var ResultWindow = Ext.create('GMRE.view.gmre.ResultWindow');",
                    "var myChart = ResultWindow.down('polar');",
                    "var playerGrid = ResultWindow.down('#playergrid');",
                    "var mechanicGrid = ResultWindow.down('#mechanicgrid');",
                    "var siteAreaName = ResultWindow.down('#siteAreaName');",
                    "",
                    "//siteAreaName.setText(siteArea);",
                    "",
                    "siteAreaName.setHtml('<H1>' + siteArea + '</H1>');",
                    "",
                    "",
                    "//1) Display player analysis results",
                    "var pointStore = Ext.create('Ext.data.JsonStore',{",
                    "    fields: ['Name', 'Point'],",
                    "    data: [",
                    "        {",
                    "            //\"Name\": \"socialiser\",",
                    "            \"Name\": \"사교가\",",
                    "            \"Point\": players.socialiser",
                    "        },",
                    "        {",
                    "            //\"Name\": \"freespirit\",",
                    "            \"Name\": \"자유주의자\",",
                    "            \"Point\": players.freespirit",
                    "        },",
                    "        {",
                    "            //\"Name\": \"achiever\",",
                    "            \"Name\": \"성취가\",",
                    "            \"Point\": players.achiever",
                    "        },",
                    "        {",
                    "            //\"Name\": \"philanthropist\",",
                    "            \"Name\": \"자선가\",",
                    "            \"Point\": players.philanthropist",
                    "        },",
                    "        {",
                    "            //\"Name\": \"player\",",
                    "            \"Name\": \"참가자\",",
                    "            \"Point\": players.player",
                    "        },",
                    "        {",
                    "            //\"Name\": \"disruptor\",",
                    "            \"Name\": \"방해자\",",
                    "            \"Point\": players.disruptor",
                    "        }",
                    "    ],",
                    "    sorters:[",
                    "        {property: 'Point', direction: 'DESC'}",
                    "    ]",
                    "});",
                    "myChart.setStore(pointStore);",
                    "playerGrid.setStore(pointStore);",
                    "",
                    "//2) Display game mechanics recommendation results",
                    "var mechanicStore = Ext.create('Ext.data.JsonStore',{",
                    "    fields: ['Name','Prefer'],",
                    "    data: mechanics,",
                    "    sorters:[",
                    "        {property: 'Prefer', direction: 'DESC'}",
                    "    ]",
                    "});",
                    "mechanicGrid.setStore(mechanicStore);",
                    "",
                    "var view = this.getView();",
                    "this.dialog = view.add(ResultWindow);",
                    "this.dialog.show();"
                ]
            },
            "name": "createDialog",
            "designerId": "8221bad2-f0ed-4cbf-aff3-0eb2f8328b08"
        }
    ]
}